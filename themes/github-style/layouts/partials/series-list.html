{{ define "series-list" }}
<div>
    <div class="position-relative">
        <div>
            <!-- Page Header -->
            <div class="text-center mb-6">
                <h1 class="f1-light mb-2">📚 시리즈</h1>
                <p class="f4 text-gray">주제별로 정리된 포스트 시리즈를 만나보세요</p>
            </div>

            <!-- Series Books Grid -->
            <div class="series-books-container">
                {{ $allSeries := slice }}
                {{ range .Site.RegularPages }}
                {{ range .Params.series }}
                {{ $allSeries = $allSeries | append . }}
                {{ end }}
                {{ end }}
                {{ $uniqueSeries := $allSeries | uniq }}

                {{ if gt (len $uniqueSeries) 0 }}
                <div class="series-books-grid" id="series-grid">
                    {{ range $uniqueSeries }}
                    {{ $seriesName := . }}
                    {{ $seriesPosts := where $.Site.RegularPages "Params.series" "intersect" (slice $seriesName) }}
                    {{ $seriesPosts = $seriesPosts.ByDate.Reverse }}

                    <div class="series-book" data-series="{{ urlize $seriesName }}" data-series-name="{{ $seriesName }}"
                        data-post-count="{{ len $seriesPosts }}">
                        <div class="book-title">{{ $seriesName }}</div>
                        <div class="book-count">{{ len $seriesPosts }}편</div>
                        {{ if $seriesPosts }}
                        <div class="book-cover-date">{{ (index $seriesPosts 0).Date.Format "2006.01" }}</div>
                        {{ end }}

                        <!-- 포스트 데이터를 숨겨진 요소로 저장 -->
                        <div class="series-posts-data" style="display: none;">
                            {{ range $index, $post := $seriesPosts }}
                            <div class="post-data" data-index="{{ add $index 1 }}" data-title="{{ $post.Title }}"
                                data-permalink="{{ $post.Permalink }}" data-date="{{ $post.Date.Format "2006년 1월 2일" }}">
                            </div>
                            {{ end }}
                        </div>
                    </div>
                    {{ end }}

                    <!-- 별도의 포스트 목록 영역 -->
                    <div class="series-posts-container" id="posts-container">
                        <div class="series-posts-header">
                            <div class="series-title-section">
                                <h2 class="series-posts-title" id="posts-title">시리즈 제목</h2>
                                <p class="series-posts-meta" id="posts-meta">0개 포스트</p>
                            </div>
                            <div class="series-navigation-controls">
                                <button id="prev-post-btn" onclick="navigatePrevPost()" class="series-nav-btn" disabled>
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path fill-rule="evenodd"
                                            d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z" />
                                    </svg>
                                    이전
                                </button>
                                <span id="post-navigation-info" class="nav-info">1 / 1</span>
                                <button id="next-post-btn" onclick="navigateNextPost()" class="series-nav-btn" disabled>
                                    다음
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path fill-rule="evenodd"
                                            d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <ul class="series-post-list" id="posts-list">
                            <!-- JavaScript로 동적 생성 -->
                        </ul>
                        <div class="series-view-all-large" id="view-all-container" style="display: none;">
                            <a href="#" id="view-all-link">전체 시리즈 보기 →</a>
                        </div>
                    </div>
                </div>
                {{ else }}
                <div class="col-12 text-center py-6">
                    <h3 class="f4 text-normal">아직 시리즈가 없습니다</h3>
                    <p class="text-gray">포스트에 series 태그를 추가하여 시리즈를 만들어보세요.</p>
                </div>
                {{ end }}
            </div>
        </div>
    </div>
</div>
<script src="{{ "/js/series-interaction.js" | relURL }}"></script>
{{ end }}
